<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Structure Viewer (Folder / JSON)</title>
    <link rel="stylesheet" href="./styles.css" />
    <link rel="icon" href="./assets/favicon.ico" type="image/x-icon" />
  </head>
  <body>
    <header class="topbar">
      <div class="title">
        <div class="h1">Structure Viewer</div>
        <div class="sub">Folder tree (File System Access API) + JSON tree</div>
      </div>

      <div class="actions">
        <div class="group load">
          <input
            id="ghRepo"
            placeholder="owner/repo"
            title="Format: owner/repo (public repositories only)"
          />
          <input
            id="ghBranch"
            placeholder="branch"
            title="Optional branch name (defaults to main)"
          />
          <button
            id="btnLoadGitHub"
            title="Load a public GitHub repository structure"
          >
            GitHub
          </button>

          <button
            id="btnPickFolder"
            title="Pick a local folder from your computer"
          >
            Folder
          </button>

          <label class="fileBtn" title="Load a local JSON file">
            JSON
            <input id="jsonInput" type="file" hidden />
          </label>
        </div>

        <div class="group tree">
          <button
            id="btnCollapseAll"
            disabled
            title="Collapse all expanded nodes"
          >
            Collapse
          </button>
          <button
            id="btnExpandAll"
            disabled
            title="Expand all nodes (may be slow)"
          >
            Expand
          </button>
        </div>

        <div class="group export">
          <button
            id="btnExportView"
            disabled
            title="Export only what is currently visible"
          >
            Export view
          </button>
          <button
            id="btnExportFull"
            disabled
            title="Expand everything and export the full tree"
          >
            Export full
          </button>
        </div>

        <div class="group settings">
          <label
            class="check"
            title="Include the current theme background in exported images"
          >
            <input id="exportUseThemeBg" type="checkbox" checked />
            <span>Theme bg</span>
          </label>

          <label
            class="check"
            title="Use file-type icons instead of generic file icons"
          >
            <input id="advancedIcons" type="checkbox" />
            <span>Icons</span>
          </label>

          <select
            id="themeSelect"
            title="Switch between light, dark, or system theme"
          >
            <option value="system">System</option>
            <option value="dark">Dark</option>
            <option value="light">Light</option>
          </select>
        </div>
      </div>
    </header>

    <main class="layout">
      <section class="panel">
        <div class="panelHeader">
          <div>
            <div class="panelTitle">Tree</div>
            <div id="meta" class="panelMeta">No data loaded.</div>
          </div>
          <div class="hint">
            Tip: Click folder triangles to expand. “Export view” captures
            exactly what’s open.
          </div>
        </div>

        <div id="treeWrap" class="treeWrap">
          <div id="tree" class="tree"></div>
        </div>
      </section>

      <section class="panel side">
        <div class="panelHeader">
          <div>
            <div class="panelTitle">Notes</div>
            <div class="panelMeta">Compatibility / behavior</div>
          </div>
        </div>

        <div class="notes">
          <ul>
            <li>
              <b>Local only.</b> All folders and JSON files are processed
              entirely in your browser. Nothing is uploaded, stored, or sent
              anywhere.
            </li>

            <li>
              <b>Folder access.</b> Folder browsing is supported in
              Chromium-based browsers (Chrome, Edge) using the File System
              Access API. Other browsers can still load JSON files.
            </li>

            <li>
              <b>GitHub load.</b> You can load the folder structure of a
              <b>public</b> GitHub repository by entering
              <code>owner/repo</code> (optionally a branch) and clicking
              “GitHub”. This uses the GitHub API and may be slow or blocked if
              you hit rate limits.
            </li>

            <li>
              <b>Theme background.</b> When enabled, exported PNG images include
              the current theme background. When disabled, exports use a
              transparent background.
            </li>

            <li>
              <b>Advanced icons.</b> Replaces generic file icons with file-type
              icons loaded from the web (based on file extensions). This may
              slightly slow down rendering on very large trees.
            </li>

            <li>
              <b>Performance.</b> Expanding very large folder structures or JSON
              files may take a moment, especially when using “Expand all”.
            </li>

            <li>
              <b>Exports.</b> “Export view” saves exactly what is currently
              expanded. “Export full” temporarily expands everything before
              exporting.
            </li>

            <li>
              <b>JSON display.</b> For arrays of objects, common fields
              (<code>name</code>, <code>username</code>, <code>title</code>,
              <code>id</code>) are used as node labels when available.
            </li>
          </ul>
        </div>
      </section>
    </main>

    <footer class="footer">
      <div class="footerInner">
        <div class="footerLeft">
          <span>All processing happens locally in your browser</span>
        </div>

        <div class="footerRight">
          <a
            href="https://github.com/smurf11k/tree-view-web"
            target="_blank"
            rel="noopener noreferrer"
          >
            GitHub
          </a>
          <span class="dot">•</span>
          <a
            href="https://github.com/smurf11k/tree-view-web/issues"
            target="_blank"
            rel="noopener noreferrer"
          >
            Report an issue
          </a>
        </div>
      </div>
    </footer>

    <!-- html2canvas for PNG export -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="./icons-map.js"></script>
    <script src="./app.js"></script>
  </body>
</html>
